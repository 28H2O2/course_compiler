<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> First集合计算 </title>
    <style>
    	body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .innerdiv {
            display: flex;
            flex-wrap: wrap; 
        }
        .grammar {
            flex: 0 1 auto;
        }

        .table-container {
            flex: 0 1 auto;
            margin-left: 50px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        td {
            border: 1px solid black;
            width: 30px;
            height: 30px;
            text-align: center;
        }
		
        input {
            width: 100%;
            height: 100%;
            border: none;
            outline: none;
            text-align: center;
        }

        .correct {
            background-color: green;
        }

        .incorrect {
            background-color: red;
        }
        .reset-button {
            background-color: #777; /* 背景颜色为红色 */
            color: #fff; /* 文字颜色为白色 */
            border: none; /* 去掉边框 */
            padding: 10px 20px; /* 添加内边距 */
            cursor: pointer; /* 鼠标悬停时显示手型光标 */
        }
        .submit-button {
            background-color: #aaa; /* 背景颜色为红色 */
            color: #000; /* 文字颜色为白色 */
            border: none; /* 去掉边框 */
            padding: 10px 20px; /* 添加内边距 */
            cursor: pointer; /* 鼠标悬停时显示手型光标 */
        }
    </style>
</head>
<body>
	<h1> First集合计算 </h1>
	<div class="innerdiv">
	    <div class="grammar">
	        <h2>计算器文法规则：</h2>
	        <p>[1] E → E1 E'</p>
	        <p>[2] E' → OP1 E1 E'</p>
	        <p>[3] E' → 𝜖</p>
	        <p>[4] E1 → E2 E1'</p>
	        <p>[5] E1' → OP2 E2 E1'</p>
	        <p>[6] E1' → 𝜖</p>
	        <p>[7] E2 → E3 E2'</p>
	        <p>[8] E2' → OP3 E2</p>
	        <p>[9] E2' → 𝜖</p>
	        <p>[10] E3 → NUM</p>
	        <p>[11] E3 → &lt;LPAR&gt; E &lt;RPAR&gt;</p>
	        <p>[12] NUM → &lt;UNUM&gt;</p>
	        <p>[13] NUM → &lt;SUB&gt; &lt;UNUM&gt;</p>
	        <p>[14] OP1 → &lt;ADD&gt;</p>
	        <p>[15] OP1 → &lt;SUB&gt;</p>
	        <p>[16] OP2 → &lt;MUL&gt;</p>
	        <p>[17] OP2 → &lt;DIV&gt;</p>
	        <p>[18] OP3 → &lt;POW&gt;</p>
	    </div>
	    <div class="table-container">
	        <h1></h1>
	    	<h2>在表格中填入相应的规则编号：如规则是[1]，填1即可，无匹配规则填入0。</h2>
	    	<form id="myForm">
			    <table>
			        <tr>
			      	    <td>  </td>
			            <td> &lt;UNUM &gt; </td>
			            <td> &lt;ADD &gt;</td>
			            <td> &lt;SUB &gt;</td>
			            <td> &lt;MUL &gt;</td>
			            <td> &lt;DIV &gt;</td>
			            <td> &lt;POW &gt;</td>
			            <td> &lt;LPAR &gt;</td>
			            <td> &lt;RPAR &gt;</td>
			            <td> 𝜖 </td>
			        </tr>
			        <tr>
			        	<td> E </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E' </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E1 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E1' </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E2 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E2' </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> E3 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> NUM </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> OP1 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> OP2 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			        <tr>
			        	<td> OP3 </td>
			            <td><input type="text" oninput="checkInput(this, 0)"></td>
			            <td><input type="text" oninput="checkInput(this, 1)"></td>
			            <td><input type="text" oninput="checkInput(this, 2)"></td>
			            <td><input type="text" oninput="checkInput(this, 3)"></td>
			            <td><input type="text" oninput="checkInput(this, 4)"></td>
			            <td><input type="text" oninput="checkInput(this, 5)"></td>
			            <td><input type="text" oninput="checkInput(this, 6)"></td>
			            <td><input type="text" oninput="checkInput(this, 7)"></td>
			            <td><input type="text" oninput="checkInput(this, 8)"></td>
			        </tr>
			    </table>
			    <input type="reset" value="重置" class="reset-button">
			    <input type="submit" value="提交" class="submit-button">
		    </form>
		    <p>填写正确显示<span style="background-color: green;">绿色</span>，错误显示<span style="background-color: red;">红色</span></p>
	    </div>
	</div>
    <script>
        // 数字数组，可以根据需要修改
        var expectedValues = [
            [1, 0, 1, 0, 0, 0, 1, 0, 0],
            [0, 2, 2, 0, 0, 0, 0, 0, 3],
            [4, 0, 4, 0, 0, 0, 4, 0, 0],
            [0, 0, 0, 5, 5, 0, 0, 0, 6],
            [7, 0, 7, 0, 0, 0, 7, 0, 0],
            [0, 0, 0, 0, 0, 8, 0, 0, 9],
            [10, 0, 10, 0, 0, 0, 11, 0, 0],
            [12, 0, 13, 0, 0, 0, 0, 0, 0],
            [0, 14, 15, 0, 0, 0, 0, 0, 0],
            [0, 0, 0, 16, 17, 0, 0, 0, 0],
            [0, 0, 0, 0, 0, 18, 0, 0, 0],
        ];
		var loadTime = new Date().getTime();
		localStorage.setItem('pageLoadTime', loadTime);
        // 检查输入是否正确，并应用相应的样式
        function checkInput(inputElement, columnIndex) {
            var rowIndex = inputElement.parentElement.parentElement.rowIndex - 1; // 获取行索引

            var expectedValue = expectedValues[rowIndex][columnIndex];
            var inputValue = inputElement.value;

            if (inputValue === expectedValue.toString()) {
                inputElement.classList.remove("incorrect");
                inputElement.classList.add("correct");
            } else {
                inputElement.classList.remove("correct");
                inputElement.classList.add("incorrect");
            }
        }
        document.getElementById("myForm").addEventListener("submit", function(event) { 
        	event.preventDefault(); // 阻止表单的默认提交行为
        	var storedLoadTime = localStorage.getItem('pageLoadTime');
			if (storedLoadTime) {
  				var currentTime = new Date().getTime();
  				var duration = currentTime - parseInt(storedLoadTime);
  				var sec = Math.floor(duration / 1000);
  				var min = Math.floor(sec / 60);
  				//var myWindow = window.open("", "用时", "width=300,height=200");
				//myWindow.document.write("用时：" + min + "分" + sec%60 + "秒");
				//const formData = new FormData(this);
				
				const data = {"用时": min + "分" + sec%60 + "秒"}
				const url = 'http://10.177.85.36:1024/log'; // 目标服务器地址
				fetch(url, {
				  method: 'POST',
				  headers: {
				    'Content-Type': 'application/json', // 根据数据类型设置适当的Content-Type
				  },
				  //body: JSON.stringify({data, formData})
				  body: JSON.stringify(data)
				})
				  .then((response) => {
				    if (!response.ok) {
				      throw new Error('网络请求失败');
				    }
				    return response.json();
				  })
				  .then((responseData) => {
				    // 处理服务器响应
				    console.log('服务器响应数据:', responseData);
				  })
				  .catch((error) => {
				    console.error('发生错误:', error);
				  });
		}
	});
    </script>
</body>
</html>
